from algRealEmbeddings import *
#import time
from random import uniform
import copy

#lengths = {(1, 2): 4.386290254987835, (4, 7): 10.5579448289947, (2, 6): 2.1695833997369136, (4, 5): 1.6940062148563753, (2, 8): 16.83405853179157,
#           (1, 4): 1.8084396572052768, (1, 3): 11.026883517351973, (1, 6): 5.8450130495737325, (3, 7): 13.787489684821617, (5, 8): 13.075209742298672, 
#           (2, 7): 11.232184203671995, (6, 8): 18.368267879186273, (1, 5): 2.00289249524296, (7, 8): 18.762183274653285, (5, 7): 10.536273659997796, 
#           (5, 6): 5.918182159410676, (2, 3): 11.29840753979362, (3, 4): 10.81796534240893}
#start = time.time()
#G = GraphEmbedding(lengths, 'Max8vertices')
#sols = G.findEmbeddings()
#print len(sols['real'])
#print len(sols['complex'])
#end = time.time()
#print 'Time: ' , end - start

#lengths = {(1, 2): 3.2154982220265746, (4, 7): 17.87967729573084, (2, 6): 1.0237800945583875, (4, 5): 17.84906203635929, (2, 8): 1.0222718473388588, 
#           (1, 4): 18.1376750081305, (1, 3): 9.972794388417462, (1, 6): 3.032569805432945, (3, 7): 9.215048223037243, (5, 8): 0.09782324287506733,
#           (2, 7): 1.436434819135262, (6, 8): 0.044659851199770367, (1, 5): 3.032338165266229, (3, 4): 19.765613007713764, (5, 7): 1.0123496857434562, 
#           (5, 6): 0.09495461781471154, (2, 3): 8.476438875510395, (7, 8): 1.0091111235946963}
#
#lengths = {(1, 2): 3.2154982220265746, (2, 7): 1.436434819135262, (4, 7): 17.87967729573084, (2, 6): 1.0237800945583875, (6, 8): 0.04465985119977037, 
#           (4, 5): 17.84906203635929, (2, 8): 1.0222718473388588, (5, 7): 1.0123496857434562, (7, 8): 1.0091111235946963, (1, 4): 18.1376750081305,
#           (1, 5): 3.032338165266229, (1, 3): 9.972794388417462, (1, 6): 3.032569805432945, (5, 6): 0.09495461781471154, (3, 7): 9.215048223037243, 
#           (3, 4): 19.765613007713764, (2, 3): 8.476438875510395, (5, 8): 0.09782324287506733}
           
#
#lengths = {(2, 7): 1.4288466263977495, (4, 7): 3.646175820991137, (2, 6): 1.0238654856293283, (4, 5): 3.3429830998046732, (2, 8): 1.0229346087847153, 
#           (1, 4): 4.49321454664234, (1, 3): 12.291475166368201, (1, 6): 3.027506184926906, (3, 7): 12.213160380343274, (5, 8): 0.09529692624044482, 
#           (1, 2): 3.214648729657953, (6, 8): 0.0179005231972465, (1, 5): 3.032338165266229, (3, 4): 10.92113783226037, (5, 7): 1.0123496857434562, 
#           (5, 6): 0.0949979939254927, (2, 3): 11.53333847125022, (7, 8): 1.0019027335371273}

#lengths = {(1, 2): 3.2232294709034446, (4, 7): 3.8174034354261854, (2, 6): 1.023865485629374, (4, 5): 3.4734613814676014, (2, 8): 1.0229346087848081, 
#           (1, 4): 4.514497903614439, (1, 3): 30.917431458441378, (1, 6): 3.0275061849268874, (3, 7): 31.199937656313235, (5, 8): 0.09529692623985034, 
#           (2, 7): 1.4047534656392475, (6, 8): 0.018779861626871987, (1, 5): 3.032338165266229, (7, 8): 1.0066546644867307, (5, 7): 1.0123496857434562, 
#           (5, 6): 0.0949979939274194, (2, 3): 30.484198141245734, (3, 4): 29.641400362571787}
           
lengths = {(1, 2): 3.2154982220265746, (4, 7): 5.053527539977335, (2, 6): 1.02378009455854, (4, 5): 4.800214122065802, (2, 8): 1.0207343645750873, 
           (1, 4): 5.839343839684607, (1, 3): 17.34824511257986, (1, 6): 3.0325698054328925, (3, 7): 17.046803669779802, (5, 8): 0.09532453043842402, 
           (2, 7): 1.4364348191352618, (6, 8): 0.029435880884050927, (1, 5): 3.03233816526623, (7, 8): 1.0093055344717898, (5, 7): 1.0123496857434564, 
           (5, 6): 0.09495461781545128, (2, 3): 16.40919471947341, (3, 4): 15.288586780382227}


lengths = {(1, 2): 14.675900223725295, (4, 7): 44.40098505939895, (2, 6): 1.6141574401570122, (4, 5): 73.69917016300796, (2, 8): 1.6175361079301915, 
           (1, 4): 45.074528193554535, (1, 3): 13.936683179078573, (1, 6): 14.587055697932326, (3, 7): 8.44927994376106, (5, 8): 57.10811293639714, 
           (2, 7): 10.697280470178171, (6, 8): 0.3633326027827166, (1, 5): 58.63814934691712, (3, 4): 45.08359408216284, (5, 7): 57.916102578212076, 
           (5, 6): 57.11467444895338, (2, 3): 10.095580488246679, (7, 8): 10.59896145194846}
alg = AlgRealEmbeddings('Max8vertices', name='8vert')
#alg.findMoreEmbeddings(lengths)

#start = time.time()
#G = GraphEmbedding(lengths, 'Max8vertices')
#sols = G.findEmbeddings()
#print len(sols['real'])
#print len(sols['complex'])
#end = time.time()
#print 'Time: ' , end - start
#
#
#n_L = {}
#for e in lengths:
#    print e,  lengths[e]
#    m,  Ls = alg.sampleEdge(lengths, e, 50)
#    print m,  Ls
#    n_L[e] = [m, Ls]
#
#print n_L

n_L = {(1, 2): [128, [14.608900355804563, 14.667787025414412, 14.726673695024262, 14.558126884505588, 14.617013554115438, 14.675900223725288, 14.734786893335137]], (2, 7): [128, [10.579507130958465, 10.638393800568315, 10.697280470178164, 10.756167139788014]], (4, 7): [128, [44.05223516072944, 44.111121830339286, 44.170008499949134, 44.22889516955898, 44.28778183916883, 44.34666850877868, 44.405555178388525, 44.46444184799837, 44.52332851760822, 44.58221518721807, 44.641101856827916, 44.699988526437764, 44.75887519604761, 44.81776186565746, 44.87664853526731, 44.935535204877155, 44.994421874487, 45.05330854409685, 44.04766504173981, 44.10655171134966, 44.16543838095951, 44.224325050569355, 44.2832117201792, 44.34209838978905, 44.4009850593989, 44.459871729008746, 44.518758398618594, 44.57764506822844, 44.63653173783829, 44.69541840744814, 44.754305077057985, 44.81319174666783, 44.87207841627768, 44.93096508588753, 44.98985175549738, 45.048738425107224]], (2, 6): [128, [1.6141574401570116]], (6, 8): [128, [0.2405529710012077, 0.29943964061105754, 0.3583263102209074, 0.4172129798307572, 0.47609964944060706, 0.2455592635630166, 0.30444593317286645, 0.3633326027827163, 0.4222192723925661]], (4, 5): [128, [66.01696292520337, 66.07584959481322, 66.13473626442307, 66.19362293403292, 66.25250960364276, 66.31139627325261, 66.37028294286246, 66.42916961247231, 66.42916961247239, 66.48805628208224, 66.54694295169209, 66.60582962130194, 66.66471629091178, 66.72360296052163, 66.78248963013148, 66.84137629974133, 66.90026296935118, 66.95914963896102, 67.01803630857087, 67.07692297818072, 67.13580964779057, 67.19469631740041, 67.25358298701026, 67.31246965662011, 67.37135632622996, 67.4302429958398, 67.48912966544965, 67.5480163350595, 67.60690300466935, 67.6657896742792, 67.72467634388904, 67.78356301349889, 67.84244968310874, 67.90133635271859, 67.96022302232844, 68.01910969193828, 68.07799636154813, 68.13688303115798, 68.19576970076783, 68.25465637037767, 68.31354303998752, 68.37242970959737, 68.43131637920722, 68.49020304881707, 68.54908971842691, 68.60797638803676, 68.66686305764661, 68.72574972725646, 68.7846363968663, 68.84352306647615, 68.902409736086, 68.96129640569585, 69.0201830753057, 69.07906974491554, 69.13795641452539, 69.19684308413524, 69.25572975374509, 69.31461642335493, 69.37350309296478, 69.37350309296488, 69.43238976257473, 69.49127643218458, 69.55016310179442, 69.60904977140427, 69.66793644101412, 69.72682311062397, 69.78570978023382, 69.84459644984366, 69.90348311945351, 69.96236978906336, 70.02125645867321, 70.08014312828305, 70.1390297978929, 70.19791646750275, 70.2568031371126, 70.31568980672245, 70.3745764763323, 70.43346314594214, 70.49234981555199, 70.55123648516184, 70.61012315477168, 70.66900982438153, 70.72789649399138, 70.78678316360123, 70.84566983321108, 70.90455650282092, 70.96344317243077, 71.02232984204062, 71.08121651165047, 71.14010318126032, 71.19898985087016, 71.25787652048001, 71.31676319008986, 71.3756498596997, 71.43453652930955, 71.4934231989194, 71.55230986852925, 71.6111965381391, 71.67008320774895, 71.7289698773588, 71.78785654696864, 71.84674321657849, 71.90562988618834, 71.96451655579818, 72.02340322540803, 72.08228989501788, 72.14117656462773, 72.20006323423758, 72.25894990384742, 72.31783657345727, 72.31783657345737, 72.37672324306722, 72.43560991267707, 72.49449658228691, 72.55338325189676, 72.61226992150661, 72.67115659111646, 72.7300432607263, 72.78892993033615, 72.847816599946, 72.90670326955585, 72.9655899391657, 73.02447660877554, 73.08336327838539, 73.14224994799524, 73.20113661760509, 73.26002328721493, 73.31890995682478, 73.37779662643463, 73.43668329604448, 73.49556996565433, 73.55445663526417, 73.61334330487402, 73.67222997448387, 73.73111664409372, 73.79000331370356, 73.84888998331341, 73.90777665292326, 73.96666332253311, 74.02554999214296, 74.0844366617528, 74.14332333136265, 74.2022100009725, 74.26109667058235, 74.3199833401922, 74.37887000980204, 74.43775667941189, 74.49664334902174, 74.55553001863159, 74.61441668824143, 74.67330335785128, 74.73219002746113, 74.79107669707098, 74.84996336668083, 74.90885003629067, 74.96773670590052, 75.02662337551037, 75.08551004512022, 75.14439671473006, 75.20328338433991, 75.26217005394976, 75.26217005394986, 75.3210567235597, 75.37994339316955, 75.4388300627794, 75.49771673238925, 75.5566034019991, 75.61549007160895, 75.6743767412188, 75.73326341082864, 75.79215008043849, 75.85103675004834, 75.90992341965818, 75.96881008926803, 76.02769675887788, 76.08658342848773, 76.14547009809758, 76.20435676770742, 76.26324343731727, 76.32213010692712, 76.38101677653697, 76.43990344614681, 76.49879011575666, 76.55767678536651, 76.61656345497636, 76.6754501245862, 76.73433679419605, 76.7932234638059, 76.85211013341575, 76.9109968030256, 76.96988347263544, 77.02877014224529, 77.08765681185514, 77.14654348146499, 77.20543015107484, 77.26431682068468, 77.32320349029453, 77.38209015990438, 77.44097682951423, 77.49986349912407, 77.55875016873392, 77.61763683834377, 77.67652350795362, 77.73541017756347, 77.79429684717331, 77.85318351678316, 77.91207018639301, 77.97095685600286, 78.0298435256127, 78.08873019522255, 72.22700342276171, 72.28589009237156, 72.34477676198141, 72.40366343159126, 72.4625501012011, 72.52143677081095, 72.5803234404208, 72.63921011003065, 72.6980967796405, 72.75698344925034, 72.81587011886019, 72.87475678847004, 72.93364345807989, 72.99253012768973, 73.05141679729958, 73.11030346690943, 73.16919013651928, 73.22807680612912, 73.28696347573897, 73.34585014534882, 73.40473681495867, 73.46362348456852, 73.52251015417836, 73.58139682378821, 73.64028349339806, 73.6991701630079, 73.75805683261775, 73.8169435022276, 73.87583017183745, 73.9347168414473, 73.99360351105715, 74.052490180667, 74.11137685027684, 74.17026351988669, 74.22915018949654, 74.28803685910638, 74.34692352871623, 74.40581019832608, 74.46469686793593, 74.52358353754578, 74.58247020715562, 74.64135687676547, 74.70024354637532, 74.75913021598517, 74.81801688559501, 74.87690355520486, 74.93579022481471, 74.99467689442456, 75.0535635640344, 75.11245023364425, 75.1713369032541]], (2, 8): [128, [1.6175361079301909]], (5, 7): [128, [57.125075814116045, 57.18396248372589, 57.24284915333574, 57.30173582294559, 57.360622492555436, 57.419509162165284, 57.47839583177513, 57.53728250138498, 57.59616917099483, 57.596169170994926, 57.655055840604774, 57.71394251021462, 57.77282917982447, 57.83171584943432, 57.890602519044165, 57.94948918865401, 58.00837585826386, 58.06726252787371, 58.12614919748356, 58.185035867093404, 58.24392253670325, 58.3028092063131, 58.36169587592295, 58.420582545532795, 58.47946921514264, 58.53835588475249, 58.59724255436234, 58.65612922397219, 58.715015893582034, 58.77390256319188, 58.83278923280173, 58.89167590241158, 58.950562572021425, 59.00944924163127, 59.06833591124112, 59.12722258085097, 59.18610925046082, 59.244995920070664, 59.30388258968051, 57.150575873284005, 57.20946254289385, 57.2683492125037, 57.32723588211355, 57.386122551723396, 57.445009221333244, 57.50389589094309, 57.56278256055294, 57.62166923016279, 57.680555899772635, 57.73944256938248, 57.79832923899233, 57.85721590860218, 57.916102578212026, 57.974989247821874, 58.03387591743172, 58.09276258704157, 58.15164925665142, 58.210535926261265, 58.26942259587111, 58.32830926548096, 58.38719593509081, 58.446082604700656, 58.504969274310504, 58.56385594392035, 58.6227426135302, 58.68162928314005, 58.740515952749895, 58.79940262235974, 58.85828929196959, 58.91717596157944, 58.976062631189286, 59.034949300799134, 59.09383597040898, 59.15272264001883, 59.21160930962868, 59.270495979238525, 59.32938264884837]], (3, 4): [128, [43.99334849111959, 44.05223516072944, 44.111121830339286, 44.170008499949134, 44.22889516955898, 44.28778183916883, 44.34666850877868, 44.405555178388525, 44.46444184799837, 44.52332851760822, 44.58221518721807, 44.641101856827916, 44.699988526437764, 44.75887519604761, 44.81776186565746, 44.87664853526731, 44.935535204877155, 44.994421874487, 45.05330854409685, 45.1121952137067, 45.171081883316546, 45.229968552926394, 45.28885522253624, 45.34774189214609, 45.40662856175594, 45.465515231365785, 45.52440190097563, 45.58328857058548, 45.64217524019533, 45.701061909805176, 45.759948579415024, 45.81883524902487, 44.02363402918553, 44.08252069879538, 44.141407368405225, 44.20029403801507, 44.25918070762492, 44.31806737723477, 44.37695404684462, 44.435840716454464, 44.49472738606431, 44.55361405567416, 44.61250072528401, 44.671387394893856, 44.7302740645037, 44.78916073411355, 44.8480474037234, 44.90693407333325, 44.965820742943095, 45.02470741255294, 45.08359408216279, 45.14248075177264, 45.201367421382486, 45.26025409099233, 45.31914076060218, 45.37802743021203, 45.43691409982188, 45.495800769431725, 45.55468743904157, 45.61357410865142, 45.67246077826127, 45.731347447871116, 45.79023411748096, 45.84912078709081, 45.90800745670066, 45.96689412631051]], (1, 4): [128, [43.99334849111959, 44.05223516072944, 44.111121830339286, 44.170008499949134, 44.22889516955898, 44.28778183916883, 44.34666850877868, 44.405555178388525, 44.46444184799837, 44.52332851760822, 44.58221518721807, 44.641101856827916, 44.699988526437764, 44.75887519604761, 44.81776186565746, 44.87664853526731, 44.935535204877155, 44.994421874487, 45.05330854409685, 45.1121952137067, 45.171081883316546, 45.229968552926394, 45.28885522253624, 45.34774189214609, 45.40662856175594, 45.465515231365785, 45.52440190097563, 45.58328857058548, 45.64217524019533, 44.014568140577225, 44.07345481018707, 44.13234147979692, 44.19122814940677, 44.250114819016616, 44.309001488626464, 44.36788815823631, 44.42677482784616, 44.48566149745601, 44.544548167065855, 44.6034348366757, 44.66232150628555, 44.7212081758954, 44.780094845505246, 44.838981515115094, 44.89786818472494, 44.95675485433479, 45.01564152394464, 45.074528193554485, 45.13341486316433, 45.19230153277418, 45.25118820238403, 45.310074871993876, 45.368961541603724, 45.42784821121357, 45.48673488082342, 45.54562155043327, 45.604508220043115]], (1, 5): [128, [57.77282917982447, 57.83171584943432, 57.890602519044165, 57.94948918865401, 58.00837585826386, 58.06726252787371, 58.12614919748356, 58.185035867093404, 58.24392253670325, 58.3028092063131, 58.36169587592295, 58.420582545532795, 58.47946921514264, 58.53835588475249, 58.59724255436234, 58.65612922397219, 58.715015893582034, 58.77390256319188, 58.83278923280173, 58.89167590241158, 58.950562572021425, 59.00944924163127, 59.06833591124112, 59.12722258085097, 59.18610925046082, 59.244995920070664, 59.30388258968051, 59.36276925929036, 59.42165592890021, 59.480542598510056, 59.5394292681199, 59.59831593772975, 59.6572026073396, 59.71608927694945, 59.774975946559294, 59.83386261616914, 59.89274928577899, 59.95163595538884, 60.010522624998686, 60.06940929460853, 57.8137359723792, 57.87262264198905, 57.931509311598894, 57.99039598120874, 58.04928265081859, 58.10816932042844, 58.167055990038286, 58.22594265964813, 58.28482932925798, 58.34371599886783, 58.40260266847768, 58.461489338087524, 58.52037600769737, 58.57926267730722, 58.63814934691707, 58.697036016526916, 58.75592268613676, 58.81480935574661, 58.87369602535646, 58.93258269496631, 58.991469364576155, 59.050356034186, 59.10924270379585, 59.1681293734057, 59.227016043015546, 59.28590271262539, 59.34478938223524, 59.40367605184509, 59.46256272145494, 59.521449391064785, 59.58033606067463, 59.63922273028448, 59.69810939989433, 59.756996069504176, 59.81588273911402, 59.87476940872387, 59.93365607833372, 59.99254274794357, 60.051429417553415]], (1, 3): [128, [12.960073606728761, 13.01896027633861, 13.07784694594846, 13.13673361555831, 13.19562028516816, 13.254506954778009, 13.313393624387858, 13.372280293997708, 13.431166963607557, 13.431166963607572, 13.490053633217421, 13.54894030282727, 13.60782697243712, 13.66671364204697, 13.72560031165682, 13.784486981266669, 13.843373650876519, 13.902260320486368, 13.961146990096218, 14.020033659706067, 14.078920329315917, 14.137806998925766, 14.196693668535616, 14.255580338145466, 14.314467007755315, 14.373353677365165, 14.432240346975014, 14.491127016584864, 12.935609795711123, 12.994496465320973, 13.053383134930822, 13.112269804540672, 13.171156474150521, 13.230043143760371, 13.28892981337022, 13.34781648298007, 13.40670315258992, 13.46558982219977, 13.524476491809619, 13.583363161419468, 13.642249831029318, 13.701136500639167, 13.760023170249017, 13.818909839858867, 13.877796509468716, 13.936683179078566, 13.995569848688415, 14.054456518298265, 14.113343187908114, 14.172229857517964, 14.231116527127813, 14.290003196737663, 14.348889866347513, 14.407776535957362, 14.466663205567212, 14.525549875177061]], (1, 6): [128, [14.52816902832247, 14.58705569793232, 14.645942367542169]], (5, 6): [128, [57.11467444895333]], (3, 7): [128, [7.778046681061985, 7.836933350671835, 7.895820020281684, 7.954706689891534, 8.013593359501384, 8.072480029111233, 8.131366698721083, 8.190253368330932, 8.249140037940782, 8.308026707550631, 8.366913377160481, 8.42580004677033, 8.48468671638018, 8.54357338599003, 8.60246005559988, 8.661346725209729, 8.720233394819578, 8.779120064429428, 8.838006734039277, 8.896893403649127, 8.955780073258977, 9.014666742868826, 9.073553412478676, 9.132440082088525, 9.191326751698375, 9.250213421308224, 9.309100090918074, 9.367986760527923, 7.801526578052707, 7.860413247662557, 7.919299917272406, 7.978186586882256, 8.037073256492105, 8.095959926101955, 8.154846595711804, 8.213733265321654, 8.272619934931503, 8.331506604541353, 8.390393274151203, 8.449279943761052, 8.508166613370902, 8.567053282980751, 8.6259399525906, 8.68482662220045, 8.7437132918103, 8.80259996142015, 8.86148663103, 8.920373300639849, 8.979259970249698, 9.038146639859548, 9.097033309469397, 9.155919979079247, 9.214806648689096, 9.273693318298946, 9.332579987908796]], (7, 8): [128, [10.540074782338603, 10.598961451948453, 10.657848121558303, 10.716734791168152]], (2, 3): [128, [9.191326751698375, 9.250213421308224, 9.309100090918074, 9.367986760527923, 9.426873430137773, 9.485760099747623, 9.544646769357472, 9.603533438967322, 9.662420108577171, 9.72130677818702, 9.78019344779687, 9.83908011740672, 9.89796678701657, 9.956853456626419, 10.015740126236269, 10.074626795846118, 10.133513465455968, 10.192400135065817, 10.251286804675667, 10.310173474285516, 10.369060143895366, 10.427946813505216, 10.486833483115065, 10.48683348311508, 10.545720152724929, 10.604606822334778, 10.663493491944628, 10.722380161554478, 10.781266831164327, 10.840153500774177, 10.899040170384026, 10.957926839993876, 11.016813509603725, 11.075700179213575, 9.212280444098928, 9.271167113708778, 9.330053783318627, 9.388940452928477, 9.447827122538326, 9.506713792148176, 9.565600461758025, 9.624487131367875, 9.683373800977725, 9.742260470587574, 9.801147140197424, 9.860033809807273, 9.918920479417123, 9.977807149026972, 10.036693818636822, 10.095580488246672, 10.154467157856521, 10.21335382746637, 10.27224049707622, 10.33112716668607, 10.39001383629592, 10.448900505905769, 10.507787175515618, 10.566673845125468, 10.625560514735318, 10.684447184345167, 10.743333853955017, 10.802220523564866, 10.861107193174716, 10.919993862784565, 10.978880532394415, 11.037767202004265, 11.096653871614114]], (5, 8): [128, [57.10811293639709]]}

new_lengths = copy.copy(lengths)
for e in lengths:
#    print e,  lengths[e]
    m,  Ls = n_L[e]
#    print m,  Ls
    if Ls and m== 128:
#        new_lengths[e] = sum(Ls)/float(len(Ls))
        if abs(min(Ls)-lengths[e])>abs(max(Ls)-lengths[e]):
            new_lengths[e] = min(Ls)
        else:
            new_lengths[e] = max(Ls)


G = GraphEmbedding(new_lengths, 'Max8vertices')
sols = G.findEmbeddings()
print 'Embeddings after resampling:'
print len(sols['real'])
print new_lengths

   

#alg = AlgRealEmbeddings('Max8vertices_distSyst', name='8vert_Resampling_of_122_DIST')#, num_phi=36, num_theta=36, factor_second=4
#alg.findMoreEmbeddings(new_lengths)










